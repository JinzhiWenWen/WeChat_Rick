webpackJsonp([12],{BVzb:function(e,i,t){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s=t("4YfN"),a=t.n(s),n=t("qqdu"),c=t("R4Sj"),l={data:function(){return{skillsPic:[],skillsFile:[],webView:[],isTwo:!0,upBtn:!0}},watch:{skillsPic:function(e,i){console.log(e.length),e.length+this.webView.length>=1?this.upBtn=!1:this.upBtn=!0,e.length+this.webView.length>=5?this.isTwo=!1:this.isTwo=!0}},computed:a()({},Object(c.c)(["userMes"])),mounted:function(){if(this.userMes.engineerVO&&this.userMes.engineerVO.certificateFiles.length>=1){var e=this.userMes.engineerVO.certificateFiles;for(var i in e)this.webView.push(e[i])}},methods:a()({},Object(c.b)(["userMes_fn"]),{upCardIs:function(e){var i=this,t=e.target.files[0],s=new FileReader;s.readAsDataURL(t);var a=new Image;s.onload=function(e){var t=document.createElement("canvas"),s=t.getContext("2d");a.src=this.result,a.onload=function(){t.width=400,t.height=a.height/a.width*400,s.drawImage(a,0,0,t.width,t.height),a.src=t.toDataURL("image/png",.1)},i.skillsPic.push(a.src)},this.skillsFile.push(e.target.files[0])},delCard:function(e){this.skillsPic.splice(e,1),this.skillsFile.splice(e,1)},delWhenPic:function(e){var i=this;console.log(this.webView[e].id);var t=this;t.$Indicator.open("删除中...");var s=new FormData;s.append("id",t.webView[e].id),s.append("type","certificateFile"),t.$axios.post(t.oUrl+"/mobile/deleteEngineerFile",s).then(function(e){0==e.data.code?(t.$Indicator.close(),t.$Toast("删除成功"),t.userMes_fn(e.data.data),e.data.data.engineerVO.certificateFiles.length>=1&&(i.webView=e.data.data.engineerVO.certificateFiles)):(t.$Indicator.close(),t.$Toast(e.data.msg))}).catch(function(e){t.$Toast("未知错误")})},sendCards:function(){var e=this;e.$Indicator.open("提交中...");var i=new FormData;i.append("id",e.userMes.engineerVO.id),i.append("certificateUploadFiles",e.skillsFile[0]),i.append("certificateUploadFiles",e.skillsFile[1]),i.append("certificateUploadFiles",e.skillsFile[2]),i.append("certificateUploadFiles",e.skillsFile[3]),i.append("certificateUploadFiles",e.skillsFile[4]),e.$axios.post(e.oUrl+"/mobile/uploadEngineerFile",i).then(function(i){console.log(i),0==i.data.code?(e.$Indicator.close(),e.userMes_fn(i.data.data),e.$Toast("提交成功"),e.$router.push({path:"/mine",query:{color:4}})):(e.$Indicator.close(),e.$Toast(i.data.msg))}).catch(function(i){e.$Indicator.close(),e.$Toast("未知错误"),console.log(i)})}}),components:{WorkHeader:n.a}},o={render:function(){var e=this,i=e.$createElement,t=e._self._c||i;return t("div",{staticClass:"cer_card"},[t("WorkHeader",[t("span",[e._v("技能认证")])]),e._v(" "),t("div",{staticStyle:{"margin-top":"7rem"}}),e._v(" "),t("ul",{staticClass:"showCardPic"},e._l(e.webView,function(i,s){return t("li",[t("img",{attrs:{src:e.oUrl+"/"+i.fileName,alt:""}}),e._v(" "),t("i",{staticClass:"iconfont icon-guanbi",on:{click:function(i){return e.delWhenPic(s)}}})])}),0),e._v(" "),t("ul",{staticClass:"showCardPic"},e._l(e.skillsPic,function(i,s){return t("li",[t("img",{attrs:{src:i,alt:""}}),e._v(" "),t("i",{staticClass:"iconfont icon-guanbi",on:{click:function(i){return e.delCard(s)}}})])}),0),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.isTwo,expression:"isTwo"}],staticClass:"card_is"},[t("input",{attrs:{type:"file",accept:"image/*",name:"",value:""},on:{change:e.upCardIs}}),e._v(" "),t("i",{staticClass:"iconfont icon-icon19"})]),e._v(" "),t("p",{staticClass:"sendCard",on:{click:function(i){return e.sendCards()}}},[e._v("提交")]),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.upBtn,expression:"upBtn"}],staticClass:"up_mask"})],1)},staticRenderFns:[]};var r=t("C7Lr")(l,o,!1,function(e){t("GnNQ")},"data-v-6399f286",null);i.default=r.exports},GnNQ:function(e,i){}});
//# sourceMappingURL=12.a04c3c35908c23a7e5e9.js.map